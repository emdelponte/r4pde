% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/compare_curves.R
\name{compare_curves}
\alias{compare_curves}
\title{Compare epidemic curves using functional GAM smoothing and clustering}
\usage{
compare_curves(
  data,
  time,
  response,
  treatment,
  environment = NULL,
  block = NULL,
  unit = NULL,
  response_scale = c("proportion", "percent"),
  eps = 1e-04,
  min_points = 5,
  grid_n = 140,
  env_ref = NULL,
  k_smooth = 10,
  k_env = 4,
  k_trt = 4,
  gamma = 1.4,
  discrete = TRUE,
  cluster_k = 4,
  hc_method = "ward.D2",
  ...
)
}
\arguments{
\item{data}{A data.frame containing epidemic curve data.}

\item{time}{Character string giving the name of the time variable.}

\item{response}{Character string giving the name of the response variable
(disease severity or incidence).}

\item{treatment}{Character string giving the name of the treatment or cultivar factor.}

\item{environment}{Optional character string giving the environment factor.}

\item{block}{Optional character string giving the block or plot factor.}

\item{unit}{Optional character string giving a unique experimental unit identifier.
If NULL, a unit is constructed from the interaction of environment, treatment,
and block (when available).}

\item{response_scale}{Character string specifying the response scale:
either \code{"proportion"} (0–1) or \code{"percent"} (0–100).}

\item{eps}{Numeric small constant retained for API compatibility.}

\item{min_points}{Minimum number of observations required per epidemic curve.}

\item{grid_n}{Number of time points used to evaluate predicted mean curves.}

\item{env_ref}{Reference environment level for adjusted predictions.
If NULL, the first level is used.}

\item{k_smooth}{Basis dimension for the global smooth over time.}

\item{k_env}{Basis dimension for the environment-specific smooth.}

\item{k_trt}{Basis dimension for the treatment-specific smooth.}

\item{gamma}{Penalization parameter passed to \code{mgcv::bam()}.}

\item{discrete}{Logical; whether to use discrete fitting in \code{bam()}.}

\item{cluster_k}{Number of clusters used to cut the hierarchical tree.}

\item{hc_method}{Clustering method passed to \code{hclust()}.}

\item{...}{Reserved for future extensions.}
}
\value{
An object of class \code{"r4pde_compare_curves"} containing:
\itemize{
\item fitted GAM object,
\item environment-adjusted predicted curves,
\item functional distance matrix,
\item hierarchical clustering,
\item treatment cluster assignments.
}
}
\description{
Fits a generalized additive model (GAM) to disease progress curves using
a beta regression (with automatic fallback to quasibinomial),
derives environment-adjusted mean curves for each treatment,
computes functional distances among treatments,
and performs hierarchical clustering of epidemic trajectories.

The function is designed for replicated plant disease epidemics
measured repeatedly over time, optionally across environments and blocks.
}
\details{
The response is internally transformed using the Smithson–Verkuilen adjustment
to avoid exact 0 and 1 values. Functional distances are computed using an
L2 norm over predicted mean curves evaluated on a common time grid.
}
\seealso{
\code{\link{plot_curves}},
\code{\link{plot_dendrogram}},
\code{\link{diagnose_curves}}
}
