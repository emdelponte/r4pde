<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Compare epidemic curves using functional GAM smoothing and clustering — compare_curves • r4pde</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compare epidemic curves using functional GAM smoothing and clustering — compare_curves"><meta name="description" content="Fits a generalized additive model (GAM) to disease progress curves using
a beta regression (with automatic fallback to quasibinomial),
derives environment-adjusted mean curves for each treatment,
computes functional distances among treatments,
and performs hierarchical clustering of epidemic trajectories.
The function is designed for replicated plant disease epidemics
measured repeatedly over time, optionally across environments and blocks."><meta property="og:description" content="Fits a generalized additive model (GAM) to disease progress curves using
a beta regression (with automatic fallback to quasibinomial),
derives environment-adjusted mean curves for each treatment,
computes functional distances among treatments,
and performs hierarchical clustering of epidemic trajectories.
The function is designed for replicated plant disease epidemics
measured repeatedly over time, optionally across environments and blocks."><meta property="og:image" content="https://emdelponte.github.io/r4pde/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">r4pde</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/emdelponte/r4pde/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Compare epidemic curves using functional GAM smoothing and clustering</h1>
      <small class="dont-index">Source: <a href="https://github.com/emdelponte/r4pde/blob/HEAD/R/compare_curves.R" class="external-link"><code>R/compare_curves.R</code></a></small>
      <div class="d-none name"><code>compare_curves.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fits a generalized additive model (GAM) to disease progress curves using
a beta regression (with automatic fallback to quasibinomial),
derives environment-adjusted mean curves for each treatment,
computes functional distances among treatments,
and performs hierarchical clustering of epidemic trajectories.</p>
<p>The function is designed for replicated plant disease epidemics
measured repeatedly over time, optionally across environments and blocks.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">compare_curves</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">time</span>,</span>
<span>  <span class="va">response</span>,</span>
<span>  <span class="va">treatment</span>,</span>
<span>  environment <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  block <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  unit <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  response_scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"proportion"</span>, <span class="st">"percent"</span><span class="op">)</span>,</span>
<span>  eps <span class="op">=</span> <span class="fl">1e-04</span>,</span>
<span>  min_points <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  grid_n <span class="op">=</span> <span class="fl">140</span>,</span>
<span>  env_ref <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  k_smooth <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  k_env <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  k_trt <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  gamma <span class="op">=</span> <span class="fl">1.4</span>,</span>
<span>  discrete <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  cluster_k <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  hc_method <span class="op">=</span> <span class="st">"ward.D2"</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A data.frame containing epidemic curve data.</p></dd>


<dt id="arg-time">time<a class="anchor" aria-label="anchor" href="#arg-time"></a></dt>
<dd><p>Character string giving the name of the time variable.</p></dd>


<dt id="arg-response">response<a class="anchor" aria-label="anchor" href="#arg-response"></a></dt>
<dd><p>Character string giving the name of the response variable
(disease severity or incidence).</p></dd>


<dt id="arg-treatment">treatment<a class="anchor" aria-label="anchor" href="#arg-treatment"></a></dt>
<dd><p>Character string giving the name of the treatment or cultivar factor.</p></dd>


<dt id="arg-environment">environment<a class="anchor" aria-label="anchor" href="#arg-environment"></a></dt>
<dd><p>Optional character string giving the environment factor.</p></dd>


<dt id="arg-block">block<a class="anchor" aria-label="anchor" href="#arg-block"></a></dt>
<dd><p>Optional character string giving the block or plot factor.</p></dd>


<dt id="arg-unit">unit<a class="anchor" aria-label="anchor" href="#arg-unit"></a></dt>
<dd><p>Optional character string giving a unique experimental unit identifier.
If NULL, a unit is constructed from the interaction of environment, treatment,
and block (when available).</p></dd>


<dt id="arg-response-scale">response_scale<a class="anchor" aria-label="anchor" href="#arg-response-scale"></a></dt>
<dd><p>Character string specifying the response scale:
either <code>"proportion"</code> (0–1) or <code>"percent"</code> (0–100).</p></dd>


<dt id="arg-eps">eps<a class="anchor" aria-label="anchor" href="#arg-eps"></a></dt>
<dd><p>Numeric small constant retained for API compatibility.</p></dd>


<dt id="arg-min-points">min_points<a class="anchor" aria-label="anchor" href="#arg-min-points"></a></dt>
<dd><p>Minimum number of observations required per epidemic curve.</p></dd>


<dt id="arg-grid-n">grid_n<a class="anchor" aria-label="anchor" href="#arg-grid-n"></a></dt>
<dd><p>Number of time points used to evaluate predicted mean curves.</p></dd>


<dt id="arg-env-ref">env_ref<a class="anchor" aria-label="anchor" href="#arg-env-ref"></a></dt>
<dd><p>Reference environment level for adjusted predictions.
If NULL, the first level is used.</p></dd>


<dt id="arg-k-smooth">k_smooth<a class="anchor" aria-label="anchor" href="#arg-k-smooth"></a></dt>
<dd><p>Basis dimension for the global smooth over time.</p></dd>


<dt id="arg-k-env">k_env<a class="anchor" aria-label="anchor" href="#arg-k-env"></a></dt>
<dd><p>Basis dimension for the environment-specific smooth.</p></dd>


<dt id="arg-k-trt">k_trt<a class="anchor" aria-label="anchor" href="#arg-k-trt"></a></dt>
<dd><p>Basis dimension for the treatment-specific smooth.</p></dd>


<dt id="arg-gamma">gamma<a class="anchor" aria-label="anchor" href="#arg-gamma"></a></dt>
<dd><p>Penalization parameter passed to <code><a href="https://rdrr.io/pkg/mgcv/man/bam.html" class="external-link">mgcv::bam()</a></code>.</p></dd>


<dt id="arg-discrete">discrete<a class="anchor" aria-label="anchor" href="#arg-discrete"></a></dt>
<dd><p>Logical; whether to use discrete fitting in <code>bam()</code>.</p></dd>


<dt id="arg-cluster-k">cluster_k<a class="anchor" aria-label="anchor" href="#arg-cluster-k"></a></dt>
<dd><p>Number of clusters used to cut the hierarchical tree.</p></dd>


<dt id="arg-hc-method">hc_method<a class="anchor" aria-label="anchor" href="#arg-hc-method"></a></dt>
<dd><p>Clustering method passed to <code><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust()</a></code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Reserved for future extensions.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class <code>"r4pde_compare_curves"</code> containing:</p><ul><li><p>fitted GAM object,</p></li>
<li><p>environment-adjusted predicted curves,</p></li>
<li><p>functional distance matrix,</p></li>
<li><p>hierarchical clustering,</p></li>
<li><p>treatment cluster assignments.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The response is internally transformed using the Smithson–Verkuilen adjustment
to avoid exact 0 and 1 values. Functional distances are computed using an
L2 norm over predicted mean curves evaluated on a common time grid.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="plot_curves.html">plot_curves</a></code>,
<code><a href="plot_dendrogram.html">plot_dendrogram</a></code>,
<code><a href="diagnose_curves.html">diagnose_curves</a></code></p></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Emerson Del Ponte.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

